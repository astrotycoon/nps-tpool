<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>NPS Pthread Pool: thr_pool.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NPS Pthread Pool
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_99e328ad83245f678db604347caa1ff5.html">src</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">thr_pool.c File Reference</div>  </div>
</div>
<div class="contents">

<p>The NPS Pthread Pool implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;sched.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="thr__pool_8h.html">thr_pool.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for thr_pool.c:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c__incl.png" border="0" usemap="#thr__pool_8c" alt=""/></div>
<map name="thr__pool_8c" id="thr__pool_8c">
<area shape="rect" id="node19" href="thr__pool_8h.html" title="The NPS Pthread Pool module interface." alt="" coords="705,86,792,117"/></map>
</div>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structjob.html">job</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Linked list of queued jobs.  <a href="structjob.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthr__pool.html">thr_pool</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">State for a Thread Pool.  <a href="structthr__pool.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#aae440fd56351741a4e9d963ee0ab1079">DEBUG_THR_POOL</a>&#160;&#160;&#160;0</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">debug level  <a href="#aae440fd56351741a4e9d963ee0ab1079"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a607b15105efe58c63086866d5654b6bc">dbugf</a>(a, s)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints to stderr "TID: file:line  &lt;string&gt;\n".  <a href="#a607b15105efe58c63086866d5654b6bc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a3a7f2c0396e245f72188f106363cd1aa">dbugdf</a>(a, s, d)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints to stderr "TID: file:line  &lt;string&gt; &lt;integer&gt;\n".  <a href="#a3a7f2c0396e245f72188f106363cd1aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ab2158b484780f6c4c964f18ce5ddbde8">dbugg</a>(a, f,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints to stderr "TID: file:line  &lt;format string&gt;\n".  <a href="#ab2158b484780f6c4c964f18ce5ddbde8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a1f1fe80a8a022e1ec0167ffb8472ac18">THR_POOL_COPY_MODE</a>&#160;&#160;&#160;0x01</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">flag: job input is copied  <a href="#a1f1fe80a8a022e1ec0167ffb8472ac18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ae93e3c7d7f76d60a26ad83b8c7bc7527">THR_POOL_DESTROY_REQUEST</a>&#160;&#160;&#160;0x01</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">destroying pool  <a href="#ae93e3c7d7f76d60a26ad83b8c7bc7527"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a75669ee2aac484c0e1266eb16749ce8a">THR_POOL_WAKE_WORKER</a>&#160;&#160;&#160;0x02</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">idle worker has been signaled  <a href="#a75669ee2aac484c0e1266eb16749ce8a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a846417d6e59fa0f5f728bb467469a72a">THR_POOL_WORKER_WOKE</a>&#160;&#160;&#160;0x04</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">ack from worker that woke  <a href="#a846417d6e59fa0f5f728bb467469a72a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#abbd012b7cdf8d62f4aef380b89d93ded">THR_POOL_INITIALIZED</a>&#160;&#160;&#160;(THR_POOL_LAST - 1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The "initialized" module state.  <a href="#abbd012b7cdf8d62f4aef380b89d93ded"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ab10ee88752574d7b2f0d98b2b0b8cd08">THR_POOL_LOCK_ERROR</a>&#160;&#160;&#160;(THR_POOL_LAST - 2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal error: a lock-related error.  <a href="#ab10ee88752574d7b2f0d98b2b0b8cd08"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a1bdfaa5e43c6ac70aa9b653a95473ce6">THR_POOL_LOCK_POOL_ERROR</a>&#160;&#160;&#160;(THR_POOL_LAST - 3)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal error: a lock-related error that affects the pool.  <a href="#a1bdfaa5e43c6ac70aa9b653a95473ce6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a31b398031c47572e5b660c3bcdfc8163">THR_POOL_PTHREAD_ERROR</a>&#160;&#160;&#160;(THR_POOL_LAST - 4)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal error: a pthread-related error.  <a href="#a31b398031c47572e5b660c3bcdfc8163"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a2d7ace2a9da08c3d48913f6be7597c66">THR_POOL_PTHREAD_POOL_ERROR</a>&#160;&#160;&#160;(THR_POOL_LAST - 5)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal error: a pthread-related error that affects the pool.  <a href="#a2d7ace2a9da08c3d48913f6be7597c66"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#abae823257af47b937ea03a11206ddea0">THR_POOL_MEM_ERROR</a>&#160;&#160;&#160;(THR_POOL_LAST - 6)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal error: a memory-related error.  <a href="#abae823257af47b937ea03a11206ddea0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a8d64cefc28ab87900ab55fcdf7140bf7">THR_POOL_MEM_POOL_ERROR</a>&#160;&#160;&#160;(THR_POOL_LAST - 7)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal error: a memory-related error that affects the pool.  <a href="#a8d64cefc28ab87900ab55fcdf7140bf7"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structjob.html">job</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ad80922c610b6e71fdc834b6bd2af79f2">job_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Simplifies defining linked lists.  <a href="#ad80922c610b6e71fdc834b6bd2af79f2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structthr__pool.html">thr_pool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Simplifies defining lists of pools.  <a href="#a20e9093369f7f9ff7511da068aadca83"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a9b32b1bc30891238ebed4b1e360f16cb">push_fn_t</a> )(void *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Simplifies casting function pointers.  <a href="#a9b32b1bc30891238ebed4b1e360f16cb"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0">thrint_create_worker</a> (<a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *pool)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc">thrint_worker_function</a> (void *arg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196">thrint_error_check</a> (int error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ac5054ebef08427ea6be074e1dd43cb12">thrint_pool_destroy</a> (<a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *pool)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458">thrint_job_free_handler</a> (<a class="el" href="thr__pool_8c.html#ad80922c610b6e71fdc834b6bd2af79f2">job_t</a> *<a class="el" href="structjob.html">job</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3">thrint_job_cleanup_handler</a> (<a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *pool)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4">thrint_worker_cleanup_handler</a> (<a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *pool)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a97b3d122250b6bf7a63aa968acc4bcbf">thrint_lock_all</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ae451f9c3f90eee56f8db501dc618c647">thrint_unlock_all</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a10ebf3b9eacda8b2ca469bfc1627c7c9">thrint_fork_child_handler</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d">thr_pool_create</a> (const unsigned int pool_min, const unsigned int pool_max, const unsigned int timeout, const pthread_attr_t *attr, <a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a> *pool_handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf">thr_pool_queue</a> (const <a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a> pool_handle, const int mode, const size_t len, void *(*func)(void *), void *arg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a45f782dc8e24ea32d736fc01270f50db">thr_pool_free</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ac8fe95259234f860e3e3210d9bba7def">thr_pool_destroy</a> (const <a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a> pool_handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#aba25165c34c5be8b6e7962bb0720f845">thr_pool_init</a> (void)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a14732059a0ea82112eb5de32ae20f65c">thr_pools_state</a> = THR_POOL_NOT_INITIALIZED</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Module state. One of: THR_POOL_INITIALIZED, THR_POOL_NOT_INITIALIZED, THR_POOL_UNRECOV_ERROR.  <a href="#a14732059a0ea82112eb5de32ae20f65c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a9c4879748e4dafd411b798015456df41">thr_pools_atfork</a> = 0</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Module state: remembers if the atfork handler was installed.  <a href="#a9c4879748e4dafd411b798015456df41"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#af6b70e3342fe42f4b7144fc6877f099d">thr_pools</a> = NULL</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">List of pools.  <a href="#af6b70e3342fe42f4b7144fc6877f099d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#a701e79a392e7e793e33899c9982abd2f">next_pool_handle</a> = -1</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Next valid handle.  <a href="#a701e79a392e7e793e33899c9982abd2f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static sigset_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#abe7e2e56e7722bff571c0fbf438c134e">fillset</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A signal set filled with all signals.  <a href="#abe7e2e56e7722bff571c0fbf438c134e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static pthread_rwlock_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thr__pool_8c.html#ad7d81ff3137e531eef7fd4f755a5754e">thr_pools_lock</a> = PTHREAD_RWLOCK_INITIALIZER</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Module lock. Protects: <a class="el" href="structjob.html#a334af83b3554a9485a390062a221103a" title="linked list holding each job">job::next</a> pointers, <a class="el" href="thr__pool_8c.html#af6b70e3342fe42f4b7144fc6877f099d" title="List of pools.">thr_pools</a>, <a class="el" href="thr__pool_8c.html#a14732059a0ea82112eb5de32ae20f65c" title="Module state. One of: THR_POOL_INITIALIZED, THR_POOL_NOT_INITIALIZED, THR_POOL_UNRECOV_ERROR.">thr_pools_state</a>, <a class="el" href="thr__pool_8c.html#a701e79a392e7e793e33899c9982abd2f" title="Next valid handle.">next_pool_handle</a>.  <a href="#ad7d81ff3137e531eef7fd4f755a5754e"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The NPS Pthread Pool implementation. </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a3a7f2c0396e245f72188f106363cd1aa"></a><!-- doxytag: member="thr_pool.c::dbugdf" ref="a3a7f2c0396e245f72188f106363cd1aa" args="(a, s, d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dbugdf</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> { \
    if (a) { \
        fprintf(stderr, <span class="stringliteral">&quot;%5ld: &quot;</span>, pthread_self()); \
        fprintf(stderr, <span class="stringliteral">&quot;%s:%d &quot;</span>, __FUNCTION__, __LINE__); \
        fprintf(stderr, <span class="stringliteral">&quot;%s %d\n&quot;</span>, s, d); \
        fflush(stderr); \
    } \
} <span class="keywordflow">while</span>(0)
</pre></div>
<p>Prints to stderr "TID: file:line  &lt;string&gt; &lt;integer&gt;\n". </p>

</div>
</div>
<a class="anchor" id="a607b15105efe58c63086866d5654b6bc"></a><!-- doxytag: member="thr_pool.c::dbugf" ref="a607b15105efe58c63086866d5654b6bc" args="(a, s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dbugf</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> { \
    if (a) { \
        fprintf(stderr, <span class="stringliteral">&quot;%5ld: &quot;</span>, pthread_self()); \
        fprintf(stderr, <span class="stringliteral">&quot;%s:%d &quot;</span>, __FUNCTION__, __LINE__); \
        fprintf(stderr, <span class="stringliteral">&quot;%s\n&quot;</span>, s); \
        fflush(stderr); \
    } \
} <span class="keywordflow">while</span>(0)
</pre></div>
<p>Prints to stderr "TID: file:line  &lt;string&gt;\n". </p>

</div>
</div>
<a class="anchor" id="ab2158b484780f6c4c964f18ce5ddbde8"></a><!-- doxytag: member="thr_pool.c::dbugg" ref="ab2158b484780f6c4c964f18ce5ddbde8" args="(a, f,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dbugg</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> { \
    if (a) { \
        fprintf(stderr, <span class="stringliteral">&quot;%5ld: &quot;</span>, pthread_self()); \
        fprintf(stderr, <span class="stringliteral">&quot;%s:%d &quot;</span>, __FUNCTION__, __LINE__); \
        fprintf(stderr, f, __VA_ARGS__); \
        fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>); \
        fflush(stderr); \
    } \
} <span class="keywordflow">while</span>(0)
</pre></div>
<p>Prints to stderr "TID: file:line  &lt;format string&gt;\n". </p>

</div>
</div>
<a class="anchor" id="aae440fd56351741a4e9d963ee0ab1079"></a><!-- doxytag: member="thr_pool.c::DEBUG_THR_POOL" ref="aae440fd56351741a4e9d963ee0ab1079" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_THR_POOL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>debug level </p>

</div>
</div>
<a class="anchor" id="a1f1fe80a8a022e1ec0167ffb8472ac18"></a><!-- doxytag: member="thr_pool.c::THR_POOL_COPY_MODE" ref="a1f1fe80a8a022e1ec0167ffb8472ac18" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_COPY_MODE&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>flag: job input is copied </p>

</div>
</div>
<a class="anchor" id="ae93e3c7d7f76d60a26ad83b8c7bc7527"></a><!-- doxytag: member="thr_pool.c::THR_POOL_DESTROY_REQUEST" ref="ae93e3c7d7f76d60a26ad83b8c7bc7527" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_DESTROY_REQUEST&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>destroying pool </p>

</div>
</div>
<a class="anchor" id="abbd012b7cdf8d62f4aef380b89d93ded"></a><!-- doxytag: member="thr_pool.c::THR_POOL_INITIALIZED" ref="abbd012b7cdf8d62f4aef380b89d93ded" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_INITIALIZED&#160;&#160;&#160;(THR_POOL_LAST - 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The "initialized" module state. </p>

</div>
</div>
<a class="anchor" id="ab10ee88752574d7b2f0d98b2b0b8cd08"></a><!-- doxytag: member="thr_pool.c::THR_POOL_LOCK_ERROR" ref="ab10ee88752574d7b2f0d98b2b0b8cd08" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_LOCK_ERROR&#160;&#160;&#160;(THR_POOL_LAST - 2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal error: a lock-related error. </p>

</div>
</div>
<a class="anchor" id="a1bdfaa5e43c6ac70aa9b653a95473ce6"></a><!-- doxytag: member="thr_pool.c::THR_POOL_LOCK_POOL_ERROR" ref="a1bdfaa5e43c6ac70aa9b653a95473ce6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_LOCK_POOL_ERROR&#160;&#160;&#160;(THR_POOL_LAST - 3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal error: a lock-related error that affects the pool. </p>

</div>
</div>
<a class="anchor" id="abae823257af47b937ea03a11206ddea0"></a><!-- doxytag: member="thr_pool.c::THR_POOL_MEM_ERROR" ref="abae823257af47b937ea03a11206ddea0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_MEM_ERROR&#160;&#160;&#160;(THR_POOL_LAST - 6)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal error: a memory-related error. </p>

</div>
</div>
<a class="anchor" id="a8d64cefc28ab87900ab55fcdf7140bf7"></a><!-- doxytag: member="thr_pool.c::THR_POOL_MEM_POOL_ERROR" ref="a8d64cefc28ab87900ab55fcdf7140bf7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_MEM_POOL_ERROR&#160;&#160;&#160;(THR_POOL_LAST - 7)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal error: a memory-related error that affects the pool. </p>

</div>
</div>
<a class="anchor" id="a31b398031c47572e5b660c3bcdfc8163"></a><!-- doxytag: member="thr_pool.c::THR_POOL_PTHREAD_ERROR" ref="a31b398031c47572e5b660c3bcdfc8163" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_PTHREAD_ERROR&#160;&#160;&#160;(THR_POOL_LAST - 4)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal error: a pthread-related error. </p>

</div>
</div>
<a class="anchor" id="a2d7ace2a9da08c3d48913f6be7597c66"></a><!-- doxytag: member="thr_pool.c::THR_POOL_PTHREAD_POOL_ERROR" ref="a2d7ace2a9da08c3d48913f6be7597c66" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_PTHREAD_POOL_ERROR&#160;&#160;&#160;(THR_POOL_LAST - 5)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal error: a pthread-related error that affects the pool. </p>

</div>
</div>
<a class="anchor" id="a75669ee2aac484c0e1266eb16749ce8a"></a><!-- doxytag: member="thr_pool.c::THR_POOL_WAKE_WORKER" ref="a75669ee2aac484c0e1266eb16749ce8a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_WAKE_WORKER&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>idle worker has been signaled </p>

</div>
</div>
<a class="anchor" id="a846417d6e59fa0f5f728bb467469a72a"></a><!-- doxytag: member="thr_pool.c::THR_POOL_WORKER_WOKE" ref="a846417d6e59fa0f5f728bb467469a72a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THR_POOL_WORKER_WOKE&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ack from worker that woke </p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ad80922c610b6e71fdc834b6bd2af79f2"></a><!-- doxytag: member="thr_pool.c::job_t" ref="ad80922c610b6e71fdc834b6bd2af79f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structjob.html">job</a> <a class="el" href="thr__pool_8c.html#ad80922c610b6e71fdc834b6bd2af79f2">job_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Simplifies defining linked lists. </p>

</div>
</div>
<a class="anchor" id="a9b32b1bc30891238ebed4b1e360f16cb"></a><!-- doxytag: member="thr_pool.c::push_fn_t" ref="a9b32b1bc30891238ebed4b1e360f16cb" args=")(void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="thr__pool_8c.html#a9b32b1bc30891238ebed4b1e360f16cb">push_fn_t</a>)(void *)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Simplifies casting function pointers. </p>

</div>
</div>
<a class="anchor" id="a20e9093369f7f9ff7511da068aadca83"></a><!-- doxytag: member="thr_pool.c::thr_pool_t" ref="a20e9093369f7f9ff7511da068aadca83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structthr__pool.html">thr_pool</a> <a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Simplifies defining lists of pools. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6de13b9b0e3fe79500e4bb7a396bb68d"></a><!-- doxytag: member="thr_pool.c::thr_pool_create" ref="a6de13b9b0e3fe79500e4bb7a396bb68d" args="(const unsigned int pool_min, const unsigned int pool_max, const unsigned int timeout, const pthread_attr_t *attr, thr_pool_handle_t *pool_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thr_pool_create </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>pool_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>pool_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pthread_attr_t *&#160;</td>
          <td class="paramname"><em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a> *&#160;</td>
          <td class="paramname"><em>pool_handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create and initialize the thread pool.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool_min</td><td>The minimum number of threads in the pool. If no jobs are present for the pool, these threads are present, but idle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pool_max</td><td>The maximum number of active threads allowed in the queue; it should be the case that pool_max should be non-zero, no less than pool_min, and no greater than THR_POOL_MAX_THREADS. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout</td><td>A value, interpreted as seconds, at most THR_POOL_MAX_TIMEOUT; if the number of active threads in the thread pool is in excess of pool_min, any thread that becomes idle will wait for timeout seconds. If no tasks are present in the queue or entered in the queue during this time, the thread will be removed from the pool and the system resources for the thread will be reclaimed; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">attr</td><td>Pointer to the POSIX thread attribute used to specify the attributes of any thread created in the thread pool. If NULL, the default attributes of pthread_create() are used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pool_handle</td><td>A handle for the thread pool. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful. On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_BAD_INPUT, THR_POOL_RESOURCE_ERROR, THR_POOL_NOT_INITIALIZED, THR_POOL_ERROR, or THR_POOL_UNRECOV_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a6de13b9b0e3fe79500e4bb7a396bb68d_cgraph.png" border="0" usemap="#thr__pool_8c_a6de13b9b0e3fe79500e4bb7a396bb68d_cgraph" alt=""/></div>
<map name="thr__pool_8c_a6de13b9b0e3fe79500e4bb7a396bb68d_cgraph" id="thr__pool_8c_a6de13b9b0e3fe79500e4bb7a396bb68d_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="176,98,331,129"/><area shape="rect" id="node10" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="868,113,1007,143"/><area shape="rect" id="node5" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="380,98,548,129"/><area shape="rect" id="node7" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="597,5,819,35"/><area shape="rect" id="node12" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="622,111,794,142"/><area shape="rect" id="node14" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3" title="thrint_job_cleanup_handler" alt="" coords="609,166,807,197"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac8fe95259234f860e3e3210d9bba7def"></a><!-- doxytag: member="thr_pool.c::thr_pool_destroy" ref="ac8fe95259234f860e3e3210d9bba7def" args="(const thr_pool_handle_t pool_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thr_pool_destroy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a>&#160;</td>
          <td class="paramname"><em>pool_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Cancels all queued jobs, kills all active threads, and frees all internal module resources related to the thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool_handle</td><td>The handle for the thread pool. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_INVALID_HANDLE, THR_POOL_NOT_INITIALIZED, THR_POOL_ERROR, or THR_POOL_UNRECOV_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_ac8fe95259234f860e3e3210d9bba7def_cgraph.png" border="0" usemap="#thr__pool_8c_ac8fe95259234f860e3e3210d9bba7def_cgraph" alt=""/></div>
<map name="thr__pool_8c_ac8fe95259234f860e3e3210d9bba7def_cgraph" id="thr__pool_8c_ac8fe95259234f860e3e3210d9bba7def_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#ac5054ebef08427ea6be074e1dd43cb12" title="thrint_pool_destroy" alt="" coords="185,5,332,35"/><area shape="rect" id="node7" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="189,59,328,90"/><area shape="rect" id="node5" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="382,5,554,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45f782dc8e24ea32d736fc01270f50db"></a><!-- doxytag: member="thr_pool.c::thr_pool_free" ref="a45f782dc8e24ea32d736fc01270f50db" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thr_pool_free </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Cancels all queued jobs, kills all active threads, and frees all internal module resources. All thread pools being managed are destroyed.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_NOT_INITIALIZED, or THR_POOL_UNRECOV_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a45f782dc8e24ea32d736fc01270f50db_cgraph.png" border="0" usemap="#thr__pool_8c_a45f782dc8e24ea32d736fc01270f50db_cgraph" alt=""/></div>
<map name="thr__pool_8c_a45f782dc8e24ea32d736fc01270f50db_cgraph" id="thr__pool_8c_a45f782dc8e24ea32d736fc01270f50db_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#ac5054ebef08427ea6be074e1dd43cb12" title="thrint_pool_destroy" alt="" coords="161,5,308,35"/><area shape="rect" id="node5" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="358,5,530,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aba25165c34c5be8b6e7962bb0720f845"></a><!-- doxytag: member="thr_pool.c::thr_pool_init" ref="aba25165c34c5be8b6e7962bb0720f845" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thr_pool_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize the thread management module data.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_RESOURCE_ERROR, THR_POOL_ERROR, or THR_POOL_UNRECOV_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_aba25165c34c5be8b6e7962bb0720f845_cgraph.png" border="0" usemap="#thr__pool_8c_aba25165c34c5be8b6e7962bb0720f845_cgraph" alt=""/></div>
<map name="thr__pool_8c_aba25165c34c5be8b6e7962bb0720f845_cgraph" id="thr__pool_8c_aba25165c34c5be8b6e7962bb0720f845_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a97b3d122250b6bf7a63aa968acc4bcbf" title="thrint_lock_all" alt="" coords="193,55,305,86"/><area shape="rect" id="node5" href="thr__pool_8c.html#ae451f9c3f90eee56f8db501dc618c647" title="thrint_unlock_all" alt="" coords="412,5,540,35"/><area shape="rect" id="node7" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="612,83,751,114"/><area shape="rect" id="node11" href="thr__pool_8c.html#a10ebf3b9eacda8b2ca469bfc1627c7c9" title="thrint_fork_child_handler" alt="" coords="157,162,341,193"/><area shape="rect" id="node13" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="390,213,562,243"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af806e108e76a58da14e10a4a2da798cf"></a><!-- doxytag: member="thr_pool.c::thr_pool_queue" ref="af806e108e76a58da14e10a4a2da798cf" args="(const thr_pool_handle_t pool_handle, const int mode, const size_t len, void *(*func)(void *), void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thr_pool_queue </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a>&#160;</td>
          <td class="paramname"><em>pool_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void *)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If there are idle threads in the pool, awaken one to perform the job. If there are no idle threads but the maximum number of threads in the pool has not been reached, create a new thread to perform the job. If no idle threads exist and the pool already has the maximum number of threads, then add the job to the queue and return success; some existing worker thread will perform the job when it becomes idle. If mode is 1, the len bytes at arg will be copied locally, and the job (when executed) will use the local copy of arg.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool_handle</td><td>The handle for the thread pool. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>Can take any value. If 1, it indicates arg should be (shallow) copied. This is useful in many scenarios, e.g. when arg is a pointer to something on the caller's stack. If arguments are not copied, the caller must ensure arg persists until a thread is scheduled for the job, and throughout the duration of that job. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The length of arg. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">func</td><td>A pointer to the job function. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arg</td><td>A pointer to the arguments for the job function. If argument is copied when enqueued, it cannot be used as an output argument. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_BAD_INPUT, THR_POOL_RESOURCE_ERROR, THR_POOL_INVALID_HANDLE, THR_POOL_NOT_INITIALIZED, THR_POOL_ERROR, or THR_POOL_UNRECOV_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_af806e108e76a58da14e10a4a2da798cf_cgraph.png" border="0" usemap="#thr__pool_8c_af806e108e76a58da14e10a4a2da798cf_cgraph" alt=""/></div>
<map name="thr__pool_8c_af806e108e76a58da14e10a4a2da798cf_cgraph" id="thr__pool_8c_af806e108e76a58da14e10a4a2da798cf_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="176,98,331,129"/><area shape="rect" id="node10" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="868,113,1007,143"/><area shape="rect" id="node5" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="380,98,548,129"/><area shape="rect" id="node7" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="597,5,819,35"/><area shape="rect" id="node12" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="622,111,794,142"/><area shape="rect" id="node14" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3" title="thrint_job_cleanup_handler" alt="" coords="609,166,807,197"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5215551bceca46329030b42fb48dc7f0"></a><!-- doxytag: member="thr_pool.c::thrint_create_worker" ref="a5215551bceca46329030b42fb48dc7f0" args="(thr_pool_t *pool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int thrint_create_worker </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates a worker thread. </p>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>Caller must acquire lock to pool.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool</td><td>A pointer to our pool </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful. On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_BAD_INPUT, or THR_POOL_PTHREAD_POOL_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_cgraph.png" border="0" usemap="#thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_cgraph" alt=""/></div>
<map name="thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_cgraph" id="thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="209,58,378,89"/><area shape="rect" id="node5" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="427,5,648,35"/><area shape="rect" id="node8" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="697,58,836,89"/><area shape="rect" id="node10" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="451,111,623,142"/><area shape="rect" id="node12" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3" title="thrint_job_cleanup_handler" alt="" coords="439,166,636,197"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_icgraph.png" border="0" usemap="#thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_icgraph" alt=""/></div>
<map name="thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_icgraph" id="thr__pool_8c_a5215551bceca46329030b42fb48dc7f0_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="208,5,429,35"/><area shape="rect" id="node8" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d" title="thr_pool_create" alt="" coords="258,59,379,90"/><area shape="rect" id="node10" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf" title="thr_pool_queue" alt="" coords="258,114,380,145"/><area shape="rect" id="node5" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="478,86,647,117"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac9590acea33cb2e638eb1effa855d196"></a><!-- doxytag: member="thr_pool.c::thrint_error_check" ref="ac9590acea33cb2e638eb1effa855d196" args="(int error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int thrint_error_check </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Some modue errors require actions to be taken on their behalf, such as changing the module state to the URECOVERABLE_ERROR_STATE. This function handles those conditions, and translates the internal errors into sensible, external errors that may be returned to the caller.</p>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>Unlike other internal functions, this function acquires the module lock; caller should not already hold a module lock.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">error</td><td>An error code </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A constant that corresponds in meaning to error; if error is not a meaningful error, it is returned unchanged. </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_ac9590acea33cb2e638eb1effa855d196_icgraph.png" border="0" usemap="#thr__pool_8c_ac9590acea33cb2e638eb1effa855d196_icgraph" alt=""/></div>
<map name="thr__pool_8c_ac9590acea33cb2e638eb1effa855d196_icgraph" id="thr__pool_8c_ac9590acea33cb2e638eb1effa855d196_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#ae451f9c3f90eee56f8db501dc618c647" title="thrint_unlock_all" alt="" coords="229,62,358,93"/><area shape="rect" id="node5" href="thr__pool_8c.html#a97b3d122250b6bf7a63aa968acc4bcbf" title="thrint_lock_all" alt="" coords="476,109,588,140"/><area shape="rect" id="node7" href="thr__pool_8c.html#aba25165c34c5be8b6e7962bb0720f845" title="thr_pool_init" alt="" coords="698,82,801,113"/><area shape="rect" id="node11" href="thr__pool_8c.html#a10ebf3b9eacda8b2ca469bfc1627c7c9" title="thrint_fork_child_handler" alt="" coords="440,164,624,195"/><area shape="rect" id="node14" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3" title="thrint_job_cleanup_handler" alt="" coords="195,321,392,352"/><area shape="rect" id="node16" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="448,296,616,327"/><area shape="rect" id="node20" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="875,268,1096,299"/><area shape="rect" id="node23" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d" title="thr_pool_create" alt="" coords="925,334,1046,365"/><area shape="rect" id="node25" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf" title="thr_pool_queue" alt="" coords="924,413,1046,444"/><area shape="rect" id="node31" href="thr__pool_8c.html#ac8fe95259234f860e3e3210d9bba7def" title="thr_pool_destroy" alt="" coords="228,478,358,509"/><area shape="rect" id="node18" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="672,321,827,352"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10ebf3b9eacda8b2ca469bfc1627c7c9"></a><!-- doxytag: member="thr_pool.c::thrint_fork_child_handler" ref="a10ebf3b9eacda8b2ca469bfc1627c7c9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void thrint_fork_child_handler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A post-fork handler for the child. Puts the child's copy of the module into a sensible state. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_cgraph.png" border="0" usemap="#thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_cgraph" alt=""/></div>
<map name="thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_cgraph" id="thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="238,5,410,35"/><area shape="rect" id="node5" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="254,59,394,90"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_icgraph.png" border="0" usemap="#thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_icgraph" alt=""/></div>
<map name="thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_icgraph" id="thr__pool_8c_a10ebf3b9eacda8b2ca469bfc1627c7c9_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#aba25165c34c5be8b6e7962bb0720f845" title="thr_pool_init" alt="" coords="238,5,341,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a33b61dadac8126ac8160cde0c928b2e3"></a><!-- doxytag: member="thr_pool.c::thrint_job_cleanup_handler" ref="a33b61dadac8126ac8160cde0c928b2e3" args="(thr_pool_t *pool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void thrint_job_cleanup_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A cleanup handler, executed by each worker thread upon completing a job. Takes the calling thread out of the list of active threads.</p>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>Leaves pool-&gt;lock acquired.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool</td><td>A pointer to our pool. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_cgraph.png" border="0" usemap="#thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_cgraph" alt=""/></div>
<map name="thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_cgraph" id="thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="252,5,391,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_icgraph.png" border="0" usemap="#thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_icgraph" alt=""/></div>
<map name="thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_icgraph" id="thr__pool_8c_a33b61dadac8126ac8160cde0c928b2e3_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="252,33,420,63"/><area shape="rect" id="node5" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="469,59,624,90"/><area shape="rect" id="node7" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="672,5,893,35"/><area shape="rect" id="node10" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d" title="thr_pool_create" alt="" coords="722,59,843,90"/><area shape="rect" id="node12" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf" title="thr_pool_queue" alt="" coords="722,114,844,145"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4eb4a5269e0dbdea896c91cabdfca458"></a><!-- doxytag: member="thr_pool.c::thrint_job_free_handler" ref="a4eb4a5269e0dbdea896c91cabdfca458" args="(job_t *job)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void thrint_job_free_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="thr__pool_8c.html#ad80922c610b6e71fdc834b6bd2af79f2">job_t</a> *&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A cleanup handler, executed by each worker thread upon completing a job. Frees the resources associated with the job.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">job</td><td>A pointer to our job. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a4eb4a5269e0dbdea896c91cabdfca458_icgraph.png" border="0" usemap="#thr__pool_8c_a4eb4a5269e0dbdea896c91cabdfca458_icgraph" alt=""/></div>
<map name="thr__pool_8c_a4eb4a5269e0dbdea896c91cabdfca458_icgraph" id="thr__pool_8c_a4eb4a5269e0dbdea896c91cabdfca458_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a10ebf3b9eacda8b2ca469bfc1627c7c9" title="thrint_fork_child_handler" alt="" coords="227,18,411,49"/><area shape="rect" id="node7" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="234,86,403,117"/><area shape="rect" id="node18" href="thr__pool_8c.html#ac5054ebef08427ea6be074e1dd43cb12" title="thrint_pool_destroy" alt="" coords="245,166,392,197"/><area shape="rect" id="node5" href="thr__pool_8c.html#aba25165c34c5be8b6e7962bb0720f845" title="thr_pool_init" alt="" coords="485,5,587,35"/><area shape="rect" id="node9" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="459,111,613,142"/><area shape="rect" id="node11" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="661,57,883,87"/><area shape="rect" id="node14" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d" title="thr_pool_create" alt="" coords="711,111,833,142"/><area shape="rect" id="node16" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf" title="thr_pool_queue" alt="" coords="711,166,833,197"/><area shape="rect" id="node20" href="thr__pool_8c.html#a45f782dc8e24ea32d736fc01270f50db" title="thr_pool_free" alt="" coords="482,166,590,197"/><area shape="rect" id="node22" href="thr__pool_8c.html#ac8fe95259234f860e3e3210d9bba7def" title="thr_pool_destroy" alt="" coords="471,221,601,251"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a97b3d122250b6bf7a63aa968acc4bcbf"></a><!-- doxytag: member="thr_pool.c::thrint_lock_all" ref="a97b3d122250b6bf7a63aa968acc4bcbf" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void thrint_lock_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A pre-fork handler. Holds all locks, so they don't enter a bad state during a fork.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_cgraph.png" border="0" usemap="#thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_cgraph" alt=""/></div>
<map name="thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_cgraph" id="thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#ae451f9c3f90eee56f8db501dc618c647" title="thrint_unlock_all" alt="" coords="166,5,295,35"/><area shape="rect" id="node5" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="345,31,484,62"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_icgraph.png" border="0" usemap="#thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_icgraph" alt=""/></div>
<map name="thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_icgraph" id="thr__pool_8c_a97b3d122250b6bf7a63aa968acc4bcbf_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#aba25165c34c5be8b6e7962bb0720f845" title="thr_pool_init" alt="" coords="166,5,269,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac5054ebef08427ea6be074e1dd43cb12"></a><!-- doxytag: member="thr_pool.c::thrint_pool_destroy" ref="ac5054ebef08427ea6be074e1dd43cb12" args="(thr_pool_t *pool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int thrint_pool_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Cancels all queued jobs, kills all active threads, and frees all internal module resources related to the thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool</td><td>The handle for the thread pool. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An indicator of whether or not the operation was successful On success: THR_POOL_SUCCESS is returned. On error: THR_POOL_LOCK_POOL_ERROR or THR_POOL_PTHREAD_POOL_ERROR is returned. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_cgraph.png" border="0" usemap="#thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_cgraph" alt=""/></div>
<map name="thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_cgraph" id="thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="203,5,375,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_icgraph.png" border="0" usemap="#thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_icgraph" alt=""/></div>
<map name="thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_icgraph" id="thr__pool_8c_ac5054ebef08427ea6be074e1dd43cb12_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a45f782dc8e24ea32d736fc01270f50db" title="thr_pool_free" alt="" coords="214,5,322,35"/><area shape="rect" id="node5" href="thr__pool_8c.html#ac8fe95259234f860e3e3210d9bba7def" title="thr_pool_destroy" alt="" coords="203,59,333,90"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae451f9c3f90eee56f8db501dc618c647"></a><!-- doxytag: member="thr_pool.c::thrint_unlock_all" ref="ae451f9c3f90eee56f8db501dc618c647" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void thrint_unlock_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A post-fork handler for the parent. Returns all locks.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>None </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_cgraph.png" border="0" usemap="#thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_cgraph" alt=""/></div>
<map name="thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_cgraph" id="thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="185,5,324,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_icgraph.png" border="0" usemap="#thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_icgraph" alt=""/></div>
<map name="thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_icgraph" id="thr__pool_8c_ae451f9c3f90eee56f8db501dc618c647_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a97b3d122250b6bf7a63aa968acc4bcbf" title="thrint_lock_all" alt="" coords="184,5,296,35"/><area shape="rect" id="node5" href="thr__pool_8c.html#aba25165c34c5be8b6e7962bb0720f845" title="thr_pool_init" alt="" coords="345,31,447,62"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afaad589dc206e64a2e0adb6bc42ebcc4"></a><!-- doxytag: member="thr_pool.c::thrint_worker_cleanup_handler" ref="afaad589dc206e64a2e0adb6bc42ebcc4" args="(thr_pool_t *pool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void thrint_worker_cleanup_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A cleanup handler, executed by each worker thread upon exiting. Takes the calling thread out of the thread pool. If the caller exited prematurely, it creates a new worker to replace it. If the caller exited as a response to the pool being destroyed, it signals anyone waiting (ie, anyone who called <a class="el" href="thr__pool_8h.html#ac8fe95259234f860e3e3210d9bba7def">thr_pool_destroy()</a>) in the case the pool is now empty.</p>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>Caller must have acquired pool-&gt;lock.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pool</td><td>A pointer to our pool. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_cgraph.png" border="0" usemap="#thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_cgraph" alt=""/></div>
<map name="thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_cgraph" id="thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="275,59,429,90"/><area shape="rect" id="node12" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="942,113,1082,143"/><area shape="rect" id="node5" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="478,59,647,90"/><area shape="rect" id="node8" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="709,5,881,35"/><area shape="rect" id="node10" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3" title="thrint_job_cleanup_handler" alt="" coords="696,59,893,90"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_icgraph.png" border="0" usemap="#thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_icgraph" alt=""/></div>
<map name="thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_icgraph" id="thr__pool_8c_afaad589dc206e64a2e0adb6bc42ebcc4_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#af8cf53d10b81253e1747bd0c6345a6dc" title="thrint_worker_function" alt="" coords="276,6,444,37"/><area shape="rect" id="node5" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="493,33,648,63"/><area shape="rect" id="node8" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d" title="thr_pool_create" alt="" coords="697,5,818,35"/><area shape="rect" id="node10" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf" title="thr_pool_queue" alt="" coords="696,59,818,90"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af8cf53d10b81253e1747bd0c6345a6dc"></a><!-- doxytag: member="thr_pool.c::thrint_worker_function" ref="af8cf53d10b81253e1747bd0c6345a6dc" args="(void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void * thrint_worker_function </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The main loop for a worker thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>A pointer to our pool. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_cgraph.png" border="0" usemap="#thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_cgraph" alt=""/></div>
<map name="thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_cgraph" id="thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_cgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="224,166,445,197"/><area shape="rect" id="node8" href="thr__pool_8c.html#ac9590acea33cb2e638eb1effa855d196" title="thrint_error_check" alt="" coords="501,58,640,89"/><area shape="rect" id="node10" href="thr__pool_8c.html#a4eb4a5269e0dbdea896c91cabdfca458" title="thrint_job_free_handler" alt="" coords="249,111,421,142"/><area shape="rect" id="node12" href="thr__pool_8c.html#a33b61dadac8126ac8160cde0c928b2e3" title="thrint_job_cleanup_handler" alt="" coords="236,5,433,35"/><area shape="rect" id="node5" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="493,193,648,223"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_icgraph.png" border="0" usemap="#thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_icgraph" alt=""/></div>
<map name="thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_icgraph" id="thr__pool_8c_af8cf53d10b81253e1747bd0c6345a6dc_icgraph">
<area shape="rect" id="node3" href="thr__pool_8c.html#a5215551bceca46329030b42fb48dc7f0" title="thrint_create_worker" alt="" coords="224,59,379,90"/><area shape="rect" id="node5" href="thr__pool_8c.html#afaad589dc206e64a2e0adb6bc42ebcc4" title="thrint_worker_cleanup_handler" alt="" coords="427,5,648,35"/><area shape="rect" id="node8" href="thr__pool_8c.html#a6de13b9b0e3fe79500e4bb7a396bb68d" title="thr_pool_create" alt="" coords="477,59,598,90"/><area shape="rect" id="node10" href="thr__pool_8c.html#af806e108e76a58da14e10a4a2da798cf" title="thr_pool_queue" alt="" coords="476,114,598,145"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="abe7e2e56e7722bff571c0fbf438c134e"></a><!-- doxytag: member="thr_pool.c::fillset" ref="abe7e2e56e7722bff571c0fbf438c134e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sigset_t <a class="el" href="thr__pool_8c.html#abe7e2e56e7722bff571c0fbf438c134e">fillset</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A signal set filled with all signals. </p>

</div>
</div>
<a class="anchor" id="a701e79a392e7e793e33899c9982abd2f"></a><!-- doxytag: member="thr_pool.c::next_pool_handle" ref="a701e79a392e7e793e33899c9982abd2f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="thr__pool_8h.html#adfc6cb75dd5c6b1b599e3a4ca3c3ad08">thr_pool_handle_t</a> <a class="el" href="thr__pool_8c.html#a701e79a392e7e793e33899c9982abd2f">next_pool_handle</a> = -1<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Next valid handle. </p>

</div>
</div>
<a class="anchor" id="af6b70e3342fe42f4b7144fc6877f099d"></a><!-- doxytag: member="thr_pool.c::thr_pools" ref="af6b70e3342fe42f4b7144fc6877f099d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="thr__pool_8c.html#a20e9093369f7f9ff7511da068aadca83">thr_pool_t</a>* <a class="el" href="thr__pool_8c.html#af6b70e3342fe42f4b7144fc6877f099d">thr_pools</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>List of pools. </p>

</div>
</div>
<a class="anchor" id="a9c4879748e4dafd411b798015456df41"></a><!-- doxytag: member="thr_pool.c::thr_pools_atfork" ref="a9c4879748e4dafd411b798015456df41" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="thr__pool_8c.html#a9c4879748e4dafd411b798015456df41">thr_pools_atfork</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Module state: remembers if the atfork handler was installed. </p>

</div>
</div>
<a class="anchor" id="ad7d81ff3137e531eef7fd4f755a5754e"></a><!-- doxytag: member="thr_pool.c::thr_pools_lock" ref="ad7d81ff3137e531eef7fd4f755a5754e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_rwlock_t <a class="el" href="thr__pool_8c.html#ad7d81ff3137e531eef7fd4f755a5754e">thr_pools_lock</a> = PTHREAD_RWLOCK_INITIALIZER<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Module lock. Protects: <a class="el" href="structjob.html#a334af83b3554a9485a390062a221103a" title="linked list holding each job">job::next</a> pointers, <a class="el" href="thr__pool_8c.html#af6b70e3342fe42f4b7144fc6877f099d" title="List of pools.">thr_pools</a>, <a class="el" href="thr__pool_8c.html#a14732059a0ea82112eb5de32ae20f65c" title="Module state. One of: THR_POOL_INITIALIZED, THR_POOL_NOT_INITIALIZED, THR_POOL_UNRECOV_ERROR.">thr_pools_state</a>, <a class="el" href="thr__pool_8c.html#a701e79a392e7e793e33899c9982abd2f" title="Next valid handle.">next_pool_handle</a>. </p>

</div>
</div>
<a class="anchor" id="a14732059a0ea82112eb5de32ae20f65c"></a><!-- doxytag: member="thr_pool.c::thr_pools_state" ref="a14732059a0ea82112eb5de32ae20f65c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="thr__pool_8c.html#a14732059a0ea82112eb5de32ae20f65c">thr_pools_state</a> = THR_POOL_NOT_INITIALIZED<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Module state. One of: THR_POOL_INITIALIZED, THR_POOL_NOT_INITIALIZED, THR_POOL_UNRECOV_ERROR. </p>

</div>
</div>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated for NPS Pthread Pool by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a></small></address>
</body>
</html>
